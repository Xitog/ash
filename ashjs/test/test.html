<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Ash Live</title>
		<link
			rel="icon"
			href="https://xitog.github.io/dgx/img/favicon.ico"
			type="image/x-icon"
		/>
		<link
			rel="shortcut icon"
			href="https://xitog.github.io/dgx/img/favicon.ico"
			type="image/x-icon"
		/>
		<link
			href="http://fonts.googleapis.com/css?family=Lobster"
			rel="stylesheet"
			type="text/css"
		/>
		<style>
			/* Original tree view css from Ross Angus */

			body {
				font-family: "Courier New", Courier, monospace;
			}

			/* It's supposed to look like a tree diagram */
			.tree,
			.tree ul,
			.tree li,
			.monotree,
			.monotree ul,
			.monotree li {
				list-style: none;
				margin: 0;
				padding: 0;
				position: relative;
			}

			.tree,
			.monotree {
				margin: 0 0 1em;
				text-align: center;
			}
			.tree,
			.tree ul,
			.monotree,
			.monotree ul {
				display: table;
			}
			.tree ul,
			.monotree ul {
				width: 100%;
			}
			.tree li,
			.monotree li {
				display: table-cell;
				padding: 0.5em 0;
				vertical-align: top;
			}
			/* _________ */
			.tree li:before,
			.monotree li:before {
				outline: solid 1px #666;
				content: "";
				left: 0;
				position: absolute;
				right: 0;
				top: 0;
			}
			.tree li:first-child:before,
			.monotree li:first-child:before {
				left: 50%;
			}
			.tree li:last-child:before,
			.monotree li:last-child:before {
				right: 50%;
			}

			.tree code,
			.tree span,
			.monotree code {
				border: solid 0.1em #666;
				border-radius: 0.2em;
				display: inline-block;
				margin: 0 0.2em 0.5em;
				padding: 0.2em 0.5em;
				position: relative;
			}
			/* If the tree represents DOM structure */
			.tree code,
			.monotree code {
				font-family: monaco, Consolas, "Lucida Console", monospace;
			}

			/* | */
			.tree ul:before,
			.tree code:before,
			.tree span:before {
				outline: solid 1px #666;
				content: "";
				height: 0.5em;
				left: 50%;
				position: absolute;
			}
			.tree ul:before {
				top: -0.5em;
			}
			.tree code:before,
			.tree span:before {
				top: -0.55em;
			}

			/* The root node doesn't connect upwards */
			.tree > li {
				margin-top: 0;
			}
			.tree > li:before,
			.tree > li:after,
			.tree > li > code:before,
			.tree > li > span:before {
				outline: none;
			}

			.tree li[data-type="expr"] > code,
			.monotree li[data-type="expr"] > code {
				background-color: #ffcccb;
			}

			h1 {
				font-family: "Lobster", cursive, monospace, "Consolas",
					"Century Gothic";
				color: #4087e4;
				font-size: 32px;
			}

			fieldset {
				width: 620px;
				margin: auto;
			}
		</style>
		<script type="module">
			import { process, tests } from "./ash.mjs";

			window.onload = main;

			function clickprocess() {
				let code = document.main.cmd.value;
				process(">>>", code);
			}

			function reset_form() {
				let expr = document.getElementById("expression").checked;
				let inst = document.getElementById("instructions").checked;
				if (expr) {
					document.getElementById("legend_cmd").innerText =
						"Type your expression";
				} else {
					document.getElementById("legend_cmd").innerText =
						"Type your instructions";
				}
				console.clear();
			}

			function main() {
				let input = document.getElementById("cmd");
				input.addEventListener("keydown", function (event) {
					if (event.key === "Enter") {
						event.preventDefault();
						document.getElementById("go").click();
					}
				});
				let go = document.getElementById("go");
				go.onclick = clickprocess;
				tests(false);
			}
		</script>
	</head>
	<body>
		<div
			style="text-align: center; padding-top: 70px; padding-bottom: 70px"
		>
			<h1>Ash</h1>
			<form name="main">
				<fieldset>
					<legend>Choose</legend>
					<input
						id="expression"
						name="mode"
						type="radio"
						onchange="reset_form()"
						checked
					/>
					<label for="expression">Expression</label>
					<input
						id="instructions"
						name="mode"
						type="radio"
						onchange="reset_form()"
					/>
					<label for="instructions">Instructions</label>
				</fieldset>
				<fieldset>
					<legend id="legend_cmd">Type your expression</legend>
					<input id="cmd" type="text" size="60" />
					<input id="go" type="button" value="Run" />
					<input
						id="res"
						type="text"
						disabled
						style="background-color: gainsboro"
					/>
				</fieldset>
				<fieldset>
					<legend>Debug</legend>
					<input
						id="debug_lex"
						name="debug_lex"
						type="checkbox"
						onchange="console.clear()"
					/>
					<label for="debug_lex">Lex</label>
					<input
						id="debug_parse"
						name="debug_parse"
						type="checkbox"
						onchange="console.clear()"
					/>
					<label for="debug_parse">Parse</label>
					<input
						id="debug_execute"
						name="debug_execute"
						type="checkbox"
						onchange="console.clear()"
					/>
					<label for="debug_execute">Execute</label>
				</fieldset>
			</form>
			<canvas
				id="screen"
				width="640"
				height="480"
				style="border: 1px solid black; margin-top: 1em"
			></canvas>
			<div id="output"></div>
		</div>
	</body>
</html>
